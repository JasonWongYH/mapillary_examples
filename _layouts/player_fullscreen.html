<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>{{ page.title }}</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <script src="http://mapillary.com/javascripts/mapillary.js" type="text/javascript"></script>

    <meta content="Mapillary" name="og:site_name">


    <script type='text/javascript'>
        var QueryString = function () {
            // This function is anonymous, is executed immediately and
            // the return value is assigned to QueryString!
            var query_string = {};
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                // If first entry with this name
                if (typeof query_string[pair[0]] === "undefined") {
                    query_string[pair[0]] = pair[1];
                    // If second entry with this name
                } else if (typeof query_string[pair[0]] === "string") {
                    var arr = [ query_string[pair[0]], pair[1] ];
                    query_string[pair[0]] = arr;
                    // If third or later entry with this name
                } else {
                    query_string[pair[0]].push(pair[1]);
                }
            }
            return query_string;
        }();
        window.onload = function (e) {
            console.log("QueryString", QueryString, window.innerWidth);
            var config = {
                image: QueryString.image,
                width: window.innerWidth,
                height: window.innerHeight
            };
            if (QueryString.virtualSeq) {
                config.legs = QueryString.virtualSeq.replace(/!/g, "|");
            }

            Mapillary.init('mapillary', config);
        }
    </script>
</head>
<body>
<div id='mapillary'></div>
<!--[if !IE]>
<script>fixScale(document);</script><![endif]-->
</body>
</html>
